<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Matrix-vector multiplication
 - Math Derivations</title>

    <link href="https://fonts.googleapis.com/css?family=Cabin|Quicksand" rel="stylesheet">

    <script>
    // mark the selected page and open the menus leading to it
    // this is easier to write in javascript than in python
    document.addEventListener('DOMContentLoaded', () => {
        let thisPage = window.location.href.split('#')[0];
        if (thisPage.endsWith('/')) {
            thisPage += 'index.html';
        }

        const [selectedLink] = [...document.querySelectorAll('#sidebar a')]
            .filter(a => (a.href === thisPage));
        selectedLink.classList.add('this-page-or-section');

        let dropdown = selectedLink.parentElement;
        while (dropdown.classList.contains('dropdown')) {
            const label = dropdown.previousElementSibling;
            const checkbox = label.previousElementSibling;
            label.classList.add('this-page-or-section');
            checkbox.checked = true;

            dropdown = dropdown.parentElement;
        }
    });
    </script>

    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
        tex: {
            inlineMath: [ ['$','$'] ],
            displayMath: [ ['$$','$$'] ],
            macros: {
                span: '\\operatorname{span}',
                rotate: '\\operatorname{rotate}',
                abs: [ "\\left| {#1} \\right|", 1 ],
                bigvec: [ "\\overrightarrow{#1}", 1 ],
                I: '\\vec{i}',
                J: '\\vec{j}',
                K: '\\vec{k}',
                T: '\\operatorname{T}',
                epsi: '\\varepsilon',
                // colors chosen so that they are distinguishable when together
                red: [ "{\\color{##c00}{#1}}", 1 ],
                blue: [ "{\\color{blue}{#1}}", 1 ],
                green: [ "{\\color{green}{#1}}", 1 ],
                magenta: [ "{\\color{magenta}{#1}}", 1 ],
                darkyellow: [ "{\\color{##ac5f00}{#1}}", 1 ],
            }
        }
    };
    </script>
    <link rel="stylesheet" href="../css/animation.css">
<link rel="stylesheet" href="../css/style.css">
</head>
<body>
<div id="content">
<div id="sidebar"><a href="../index.html">Front page</a>
        <input type="checkbox" id="sidebar-checkbox-0" />
        <label for="sidebar-checkbox-0">Equations and functions</label>
        <div class="dropdown">
            <a href="../eqs-and-funcs/inverse-funcs.html">Inverse functions</a><a href="../eqs-and-funcs/how-equations-work.html">How solving equations works</a><a href="../eqs-and-funcs/incdec-funcs.html">Strictly increasing/decreasing functions</a><a href="../eqs-and-funcs/how-inequations-work.html">How solving inequalities works</a>
        </div>
        
        <input type="checkbox" id="sidebar-checkbox-2" />
        <label for="sidebar-checkbox-2">Vectors</label>
        <div class="dropdown">
            
        <input type="checkbox" id="sidebar-checkbox-1" />
        <label for="sidebar-checkbox-1">Dot product</label>
        <div class="dropdown">
            <a href="../vectors/dot-projection.html">Projection</a><a href="../vectors/angle-between-vectors.html">Angle between vectors</a><a href="../vectors/iwi-jwj.html">$\I$'s with $\I$'s, $\J$'s with $\J$'s</a>
        </div>
        
        </div>
        
        <input type="checkbox" id="sidebar-checkbox-3" />
        <label for="sidebar-checkbox-3">Discrete math</label>
        <div class="dropdown">
            <a href="../discrete/sums.html">Sum formulas</a><a href="../discrete/binom.html">Binomial coefficients</a>
        </div>
        
        <input type="checkbox" id="sidebar-checkbox-6" />
        <label for="sidebar-checkbox-6">Plane geometry</label>
        <div class="dropdown">
            
        <input type="checkbox" id="sidebar-checkbox-4" />
        <label for="sidebar-checkbox-4">Circle</label>
        <div class="dropdown">
            <a href="../plane-geometry/inscribed-angle-theorem.html">Inscribed angle theorem</a>
        </div>
        
        <input type="checkbox" id="sidebar-checkbox-5" />
        <label for="sidebar-checkbox-5">Triangle</label>
        <div class="dropdown">
            <a href="../plane-geometry/law-of-sines.html">Law of sines</a><a href="../plane-geometry/law-of-cosines.html">Law of cosines</a><a href="../plane-geometry/inscribed-circle.html">Inscribed circle</a>
        </div>
        
        </div>
        
        <input type="checkbox" id="sidebar-checkbox-11" />
        <label for="sidebar-checkbox-11">Analytic plane geometry</label>
        <div class="dropdown">
            
        <input type="checkbox" id="sidebar-checkbox-7" />
        <label for="sidebar-checkbox-7">Transforming curves</label>
        <div class="dropdown">
            <a href="../analytic-plane-geometry/reflect.html">Reflecting</a><a href="../analytic-plane-geometry/shift.html">Shifting</a><a href="../analytic-plane-geometry/stretch.html">Stretching</a>
        </div>
        
        <input type="checkbox" id="sidebar-checkbox-8" />
        <label for="sidebar-checkbox-8">Line</label>
        <div class="dropdown">
            <a href="../analytic-plane-geometry/line-eq-normal.html">Equation in normal form</a><a href="../analytic-plane-geometry/distance-line-point.html">Distance between line and point</a><a href="../analytic-plane-geometry/line-eq-slope.html">Equation with slope</a><a href="../analytic-plane-geometry/line-eq-slope-and-point.html">Equation from known slope and point</a><a href="../analytic-plane-geometry/angle-between-lines.html">Angle between lines</a><a href="../analytic-plane-geometry/slope-tan.html">Slope and tan</a><a href="../analytic-plane-geometry/line-eq-determinant.html">Equation with determinant</a>
        </div>
        
        <input type="checkbox" id="sidebar-checkbox-9" />
        <label for="sidebar-checkbox-9">Parabola</label>
        <div class="dropdown">
            <a href="../analytic-plane-geometry/parabola.html">Equation of parabola</a>
        </div>
        
        <input type="checkbox" id="sidebar-checkbox-10" />
        <label for="sidebar-checkbox-10">Hyperbola</label>
        <div class="dropdown">
            <a href="../analytic-plane-geometry/why-its-hyperbola.html">Why is $y=\frac{1}{x}$ a hyperbola?</a>
        </div>
        
        </div>
        
        <input type="checkbox" id="sidebar-checkbox-16" />
        <label for="sidebar-checkbox-16">Calculus</label>
        <div class="dropdown">
            
        <input type="checkbox" id="sidebar-checkbox-12" />
        <label for="sidebar-checkbox-12">Limits</label>
        <div class="dropdown">
            <a href="../calc/limit-def.html">Definition of limit</a><a href="../calc/limit-basics.html">Limit basics</a><a href="../calc/limit-props.html">Limit properties</a><a href="../calc/limit-1sided.html">One-sided limits</a><a href="../calc/limit-ineq.html">Inequality and limit</a><a href="../calc/limit-vector.html">Limit of vector</a>
        </div>
        
        <input type="checkbox" id="sidebar-checkbox-13" />
        <label for="sidebar-checkbox-13">Continuity</label>
        <div class="dropdown">
            <a href="../calc/cont-def.html">Definitions of continuity</a><a href="../calc/cont-props.html">Continuity properties</a>
        </div>
        
        <input type="checkbox" id="sidebar-checkbox-14" />
        <label for="sidebar-checkbox-14">Derivative</label>
        <div class="dropdown">
            <a href="../calc/derivative-def.html">Definition of derivative</a><a href="../calc/derivative-notation.html">Notation for derivatives</a><a href="../calc/derivative-power-rule-1.html">Power rule, part 1</a><a href="../calc/derivative-basic-rules.html">Basic derivative rules</a><a href="../calc/derivative-chain-rule.html">Chain rule</a><a href="../calc/derivative-power-rule-2.html">Power rule, part 2</a><a href="../calc/derivative-product-quotient-rules.html">Product rule and quotient rule</a><a href="../calc/derivative-vector.html">Derivative of vector</a>
        </div>
        
        <input type="checkbox" id="sidebar-checkbox-15" />
        <label for="sidebar-checkbox-15">Integral</label>
        <div class="dropdown">
            <a href="../calc/integral-intro.html">Introduction to integrals</a><a href="../calc/integral-refinement.html">Refinement of partition</a><a href="../calc/integral-def.html">Defining the integral</a><a href="../calc/integral-average.html">Average</a><a href="../calc/integral-ftoc1.html">Fundamental theorem of calculus, part 1</a><a href="../calc/integral-ftoc2.html">Fundamental theorem of calculus, part 2</a><a href="../calc/integral-notation.html">More notation for integrals</a><a href="../calc/integral-rules.html">Integral rules</a><a href="../calc/integral-usub.html">U substitution</a><a href="../calc/integral-sor-volume.html">Volume of solid of revolution</a><a href="../calc/integral-sor-area.html">Area of surface of revolution</a>
        </div>
        
        </div>
        
        <input type="checkbox" id="sidebar-checkbox-17" />
        <label for="sidebar-checkbox-17">Complex numbers</label>
        <div class="dropdown">
            <a href="../complex/intro.html">Introduction</a><a href="../complex/angle-and-len.html">Angle and length</a><a href="../complex/mul.html">Multiplication</a><a href="../complex/div.html">Division</a><a href="../complex/sqrt.html">Square root</a><a href="../complex/derivative.html">Derivative</a><a href="../complex/exp.html">Exponent function</a>
        </div>
        
        <input type="checkbox" id="sidebar-checkbox-18" />
        <label for="sidebar-checkbox-18">Linear algebra</label>
        <div class="dropdown">
            <a href="rotating-intro.html">Introduction (rotating a vector)</a><a href="matrix-vector.html">Matrix times vector</a><a href="matrix-matrix.html">Matrix times matrix</a><a href="matrix-sum.html">Matrix plus matrix</a><a href="matrix-num.html">Matrix times number</a><a href="span-and-dep-defs.html">Defining span and linear (in)dependence</a><a href="span-and-dep-finding.html">Finding span and checking linear (in)dependence</a><a href="matrix-inverse.html">Inverse matrices</a><a href="transpose.html">Transpose</a><a href="inverse-finding.html">Finding inverse matrices</a><a href="inverse-2x2.html">$2 \times 2$ inverse formula</a>
        </div>
        </div>
<h1 id="matrix-vector-multiplication">Matrix-vector multiplication<a class="headerlink" href="#matrix-vector-multiplication" title="Link to this title">¶</a></h1><p>Let $f$ be a linear function with 2D vectors as inputs.
<a href="rotating-intro.html">Previously</a> we noticed that the whole function is completely defined by $\red{f(1,0)}$ and $\blue{f(0,1)}$;
if you know what those are, you can calculate $f(x,y)=x\red{f(1,0)}+y\blue{f(0,1)}$ with any $x$ and $y$.
We will now introduce some notation to make this easier.</p>

<h2 id="matrices-as-a-way-to-write-a-linear-function">Matrices as a way to write a linear function<a class="headerlink" href="#matrices-as-a-way-to-write-a-linear-function" title="Link to this title">¶</a></h2><p>It is common to write the vectors $\red{f(1,0)}$ and $\blue{f(0,1)}$ into a matrix
so that $\red{f(1,0)}$ is the first column and $\blue{f(0,1)}$ is the second column.
For example, for $\red{f(1,0) = (2,3)}$ and $\blue{f(0,1) = (4,5)}$,
the matrix would be
$$
\begin{bmatrix} \red2&\blue4 \\ \red3&\blue5 \end{bmatrix}.
$$
A matrix is just a grid of numbers.
It doesn't have to be the same size in both directions.
For example, if $f$ takes 3D inputs and produces 2D outputs,
so that $\red{f(1,0,0)=(2,3)}$, $\blue{f(0,1,0)=(4,5)}$ and $\green{f(0,0,1)=(6,7)}$,
the matrix would be
$$
\begin{bmatrix} \red2&\blue4&\green6 \\ \red3&\blue5&\green7 \end{bmatrix}.
$$</p>

<div class="box graybox"><p>The <b>matrix</b> of a linear function $f$
is a matrix whose columns are $f(1,0,0,\dots,0)$, $f(0,1,0,\dots,0)$, $\dots$, $f(0,0,\dots,0,1)$,
written vertically.
</p>

</div><p>A matrix with 2 rows and 3 columns is also called a $2 \times 3$ matrix.
Note that the number of rows goes first, even though usually $x$ goes before $y$.
To prevent this confusion, in these derivations I tend to say something like
"width 3 and height 2" instead of "$2 \times 3$ matrix".</p>

<p>Examples:
<ul><li>
    Any rotation around the origin is a linear function.
    With 90 degrees counter-clockwise,
    $(1,0)$ rotates to $\red{(0,1)}$ and $(0,1)$ rotates to $\blue{(-1,0)}$,
    so the matrix
    $$
    \begin{bmatrix} \red 0 & \blue{-1} \\ \red{1} & \blue 0 \end{bmatrix}
    $$
    represents a rotation by 90 degrees counter-clockwise.
</li><li>
    Rotating $(1,0)$ counter-clockwise by any angle $\theta$ gives $\red{(\cos(\theta),\sin(\theta))}$,
    and rotating $(0,1)$ gives $\blue{(-\sin(\theta),\cos(\theta))}$.
    This was explained in <a href="rotating-intro.html#arbitrary-angle">the previous derivation</a>.
    The matrix representing the rotation is
    $$
    \begin{bmatrix} \red{\cos(\theta)} & \blue {-\sin(\theta)} \\ \red{\sin(\theta)} & \blue{\cos(\theta)} \end{bmatrix}.
    $$
    This is called a <b>rotation matrix</b>. If you plug in $\theta=90^\circ$, you should get the same matrix as above.
</li><li>
    The matrix
    $$
    \begin{bmatrix} \red 1 & \blue{1} \\ \red{0} & \blue 1 \end{bmatrix}
    $$
    corresponds with a linear function $f$ for which $f(1,0)=(1,0)$ unchanged,
    but $f(0,1)=(1,1)$ is more to the right than $(0,1)$ was originally,
    like with <i>italic text</i>.
    This linear function is called a <b>shear</b>.</p>

<p><img width="513" height="172" class="asymptote" src="../images/asy/985b4f092bb6a12c8f3f0c6c583b9088.svg" /></p><p>For a better visualization of the shear, see
<a href="https://www.youtube.com/watch?v=kYB8IZa5AuE&t=8m30s">this 3blue1brown video</a> starting at 8:30.
In general, 3blue1brown's linear algebra videos are really good and you should watch them.</p>

<p></li><li>
    The function $f(x,y)=(x,y)$ (i.e. do nothing) is a linear function.
    Because $\red{f(1,0)=(1,0)}$ and $\blue{f(0,1)=(0,1)}$, its matrix is
    $$
    I = \begin{bmatrix} \red 1 & \blue 0 \\ \red 0 & \blue 1 \end{bmatrix}.
    $$
    This matrix is called the <b>identity matrix</b>,
    and the "do nothing" function is correspondingly called the <b>identity function</b>.
    This also works with any other dimension instead of 2.
    For example, the $4 \times 4$ identity matrix is
    $$
    I = \begin{bmatrix} 1&0&0&0 \\ 0&1&0&0 \\ 0&0&1&0 \\ 0&0&0&1 \end{bmatrix}.
    $$
    In linear algebra, the letter $I$ can mean an identity matrix of any size,
    and the size should be clear from how $I$ is used.
</li><li>
    The <b>zero matrix</b>
    $$
    O = \begin{bmatrix} 0&0 \\ 0&0 \end{bmatrix}
    $$
    corresponds with a linear function that always outputs a zero vector.
    As with $I$, the letter $O$ can refer to a zero matrix of any size.
</li></ul>
</p>

<h2 id="introducing-matrix-vector-multiplication">Introducing matrix-vector multiplication<a class="headerlink" href="#introducing-matrix-vector-multiplication" title="Link to this title">¶</a></h2><p>In this context, instead of writing vectors like $(10,20)$,
they are usually written like
$$
\begin{bmatrix}10\\20\end{bmatrix}.
$$
Writing a matrix and a vector next to each other, e.g.
$$
\begin{bmatrix}2&4 \\ 3&5 \end{bmatrix}\begin{bmatrix}10\\20\end{bmatrix}
$$
means $f(\text{the vector})$, where $f$ is the linear function corresponding to the matrix.
For example, with a 2D linear function $f$, we have $f(x,y)=x\red{f(1,0)}+y\blue{f(0,1)}$,
so if $\red{f(1,0)=(2,3)}$ and $\blue{f(0,1)=(4,5)}$, we get
$$
\begin{align}
f({10},{20})&={10}\red{f(1,0)}+{20}\blue{f(0,1)} \\
= \begin{bmatrix} \red2 & \blue4 \\ \red3 & \blue5 \end{bmatrix}
    \begin{bmatrix} {10} \\ {20} \end{bmatrix}
&= {10}\red{\begin{bmatrix} 2 \\ 3 \end{bmatrix}} + {20}\blue{\begin{bmatrix}4 \\ 5 \end{bmatrix}}
=\begin{bmatrix} 20+80 \\ 30+100 \end{bmatrix}
= \begin{bmatrix} 100 \\ 130 \end{bmatrix}.
\end{align}
$$</p>

<div class="box graybox"><p><b>Multiplying a matrix and a vector</b> means
creating a linear combination of the columns of the matrix
with numbers from the vector as coefficients.
This calculates $f(\text{the vector})$,
where $f$ is the linear function corresponding to the matrix.
</p>

</div><p>I will <a href="matrix-sum.html#added-matrices-with-matrix-vector-multiplication">later</a> explain why this operation is called multiplying.</p>

<p>Examples:
<ul><li>
    To rotate the vector $(2,1)$ counter-clockwise 90 degrees, you can calculate
    $$
    \begin{bmatrix} \red 0 & \blue{-1} \\ \red{1} & \blue 0 \end{bmatrix}
    \begin{bmatrix} 2 \\ 1 \end{bmatrix}
    = 2\red{\begin{bmatrix}0\\1\end{bmatrix}}+1\blue{\begin{bmatrix}-1\\0\end{bmatrix}}
    = \begin{bmatrix}-1\\2\end{bmatrix}.
    $$
    This is the same result we got <a href="rotating-intro.html#90-degrees-counter-clockwise">here</a>.
</li><li>
    To rotate $(2,1)$ counter-clockwise by any angle $\theta$, we can now calculate
    $$
    \begin{bmatrix} \red{\cos(\theta)} & \blue {-\sin(\theta)} \\ \red{\sin(\theta)} & \blue{\cos(\theta)} \end{bmatrix}
    \begin{bmatrix}2\\1\end{bmatrix}
    = 2\red{\begin{bmatrix}\cos(\theta)\\ \sin(\theta)\end{bmatrix}}+1\blue{\begin{bmatrix}-\sin(\theta)\\ \cos(\theta)\end{bmatrix}}
    = \begin{bmatrix}2\cos(\theta)-\sin(\theta)\\ 2\sin(\theta)+\cos(\theta)\end{bmatrix}.
    $$
    This would be difficult to do without linear algebra,
    but this way it's easy.
</li><li>
    Applying the shear to $(1,1)$ gives
    $$
    \begin{bmatrix} \red 1 & \blue{1} \\ \red{0} & \blue 1 \end{bmatrix}
    \begin{bmatrix} 1 \\ 1 \end{bmatrix}
    = 1\red{\begin{bmatrix}1\\0\end{bmatrix}} + 1\blue{\begin{bmatrix}1\\1\end{bmatrix}}
    = \begin{bmatrix}2\\1\end{bmatrix}.
    $$</p>

<p><img width="633" height="172" class="asymptote" src="../images/asy/875c75cbc61309a7f6017ded7c1b62a0.svg" /></p><p></li><li>
    Multiplying a vector by the identity matrix $I$ does nothing:
    $$
    \begin{bmatrix} \red 1 & \blue 0 & \green 0 \\ \red 0 & \blue 1 & \green 0 \\ \red 0 & \blue 0 & \green 1 \end{bmatrix}
    \begin{bmatrix} 1 \\ 2 \\ 3 \end{bmatrix}
    = 1\red{\begin{bmatrix}1\\0\\0\end{bmatrix}}
    + 2\blue{\begin{bmatrix}0\\1\\0\end{bmatrix}}
    + 3\green{\begin{bmatrix}0\\0\\1\end{bmatrix}}
    = \begin{bmatrix}1\\2\\3\end{bmatrix}
    $$
</li><li>
    Multiplying a vector by the zero matrix $O$ always results in the zero vector:
    $$
    \begin{bmatrix} \red 0 & \blue 0 & \green 0 \\ \red 0 & \blue 0 & \green 0 \\ \red 0 & \blue 0 & \green 0 \end{bmatrix}
    \begin{bmatrix} 1 \\ 2 \\ 3 \end{bmatrix}
    = 1\red{\begin{bmatrix}0\\0\\0\end{bmatrix}}
    + 2\blue{\begin{bmatrix}0\\0\\0\end{bmatrix}}
    + 3\green{\begin{bmatrix}0\\0\\0\end{bmatrix}}
    = \begin{bmatrix}0\\0\\0\end{bmatrix}
    $$
</li></ul>
</p>

<h2 id="input-and-output-dimensions">Input and output dimensions<a class="headerlink" href="#input-and-output-dimensions" title="Link to this title">¶</a></h2><p>Because the numbers in the input vector correspond with the columns of the matrix,
there must be the same number of columns as there are numbers in the vector.
For example, this matrix-vector multiplication is undefined,
because the vector contains 2 numbers but the matrix has 3 columns:
$$
\begin{bmatrix} \red1&\blue3&\green5 \\ \red2&\blue4&\green6 \end{bmatrix} \begin{bmatrix} 7 \\ 8 \end{bmatrix}
= 7\red{\begin{bmatrix}1 \\ 2\end{bmatrix}} + 8\blue{\begin{bmatrix}3 \\ 4\end{bmatrix}} + \text{???}\green{\begin{bmatrix}5 \\ 6\end{bmatrix}}
$$
Here's a matrix-vector multiplication that actually works:
$$
\begin{bmatrix} \red1&\blue3&\green5 \\ \red2&\blue4&\green6 \end{bmatrix} \begin{bmatrix} 7\\8\\9 \end{bmatrix}
= 7\red{\begin{bmatrix}1 \\ 2\end{bmatrix}} + 8\blue{\begin{bmatrix}3 \\ 4\end{bmatrix}} + 9\green{\begin{bmatrix}5 \\ 6\end{bmatrix}}
= \begin{bmatrix}76 \\ 100\end{bmatrix}
$$
Here the width of the matrix is 3 and the height is 2.
It can be multiplied with 3D vectors, and the result is a 2D vector.
This works in general.</p>

<div class="box graybox"><p>The width of a matrix is the dimension of its input vectors.
The height of a matrix is the dimension of its output vectors.
</p>

</div></div>
</body>
</html>
